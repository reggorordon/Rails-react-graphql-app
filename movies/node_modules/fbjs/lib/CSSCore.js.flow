/**
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 * @providesModule CSSCore
 * @typechecks
 */
<<<<<<< HEAD

const invariant = require('./invariant');

=======
const invariant = require("./invariant");
>>>>>>> b22d4f639358533e1bbd355b77d7a3342c6a63e8
/**
 * The CSSCore module specifies the API (and implements most of the methods)
 * that should be used when dealing with the display of elements (via their
 * CSS classes and visibility on screen. It is an API focused on mutating the
 * display and not reading it as no logical state should be encoded in the
 * display of elements.
 */

/* Slow implementation for browsers that don't natively support .matches() */
<<<<<<< HEAD
function matchesSelector_SLOW(element, selector) {
  let root = element;
=======


function matchesSelector_SLOW(element, selector) {
  let root = element;

>>>>>>> b22d4f639358533e1bbd355b77d7a3342c6a63e8
  while (root.parentNode) {
    root = root.parentNode;
  }

  const all = root.querySelectorAll(selector);
  return Array.prototype.indexOf.call(all, element) !== -1;
}

const CSSCore = {
<<<<<<< HEAD

=======
>>>>>>> b22d4f639358533e1bbd355b77d7a3342c6a63e8
  /**
   * Adds the class passed in to the element if it doesn't already have it.
   *
   * @param {DOMElement} element the element to set the class on
   * @param {string} className the CSS className
   * @return {DOMElement} the element passed in
   */
  addClass: function (element, className) {
    invariant(!/\s/.test(className), 'CSSCore.addClass takes only a single class name. "%s" contains ' + 'multiple classes.', className);

    if (className) {
      if (element.classList) {
        element.classList.add(className);
      } else if (!CSSCore.hasClass(element, className)) {
        element.className = element.className + ' ' + className;
      }
    }
<<<<<<< HEAD
=======

>>>>>>> b22d4f639358533e1bbd355b77d7a3342c6a63e8
    return element;
  },

  /**
   * Removes the class passed in from the element
   *
   * @param {DOMElement} element the element to set the class on
   * @param {string} className the CSS className
   * @return {DOMElement} the element passed in
   */
  removeClass: function (element, className) {
    invariant(!/\s/.test(className), 'CSSCore.removeClass takes only a single class name. "%s" contains ' + 'multiple classes.', className);

    if (className) {
      if (element.classList) {
        element.classList.remove(className);
      } else if (CSSCore.hasClass(element, className)) {
        element.className = element.className.replace(new RegExp('(^|\\s)' + className + '(?:\\s|$)', 'g'), '$1').replace(/\s+/g, ' ') // multiple spaces to one
        .replace(/^\s*|\s*$/g, ''); // trim the ends
      }
    }
<<<<<<< HEAD
=======

>>>>>>> b22d4f639358533e1bbd355b77d7a3342c6a63e8
    return element;
  },

  /**
   * Helper to add or remove a class from an element based on a condition.
   *
   * @param {DOMElement} element the element to set the class on
   * @param {string} className the CSS className
   * @param {*} bool condition to whether to add or remove the class
   * @return {DOMElement} the element passed in
   */
  conditionClass: function (element, className, bool) {
    return (bool ? CSSCore.addClass : CSSCore.removeClass)(element, className);
  },

  /**
   * Tests whether the element has the class specified.
   *
   * @param {DOMNode|DOMWindow} element the element to check the class on
   * @param {string} className the CSS className
   * @return {boolean} true if the element has the class, false if not
   */
  hasClass: function (element, className) {
    invariant(!/\s/.test(className), 'CSS.hasClass takes only a single class name.');
<<<<<<< HEAD
    if (element.classList) {
      return !!className && element.classList.contains(className);
    }
=======

    if (element.classList) {
      return !!className && element.classList.contains(className);
    }

>>>>>>> b22d4f639358533e1bbd355b77d7a3342c6a63e8
    return (' ' + element.className + ' ').indexOf(' ' + className + ' ') > -1;
  },

  /**
   * Tests whether the element matches the selector specified
   *
   * @param {DOMNode|DOMWindow} element the element that we are querying
   * @param {string} selector the CSS selector
   * @return {boolean} true if the element matches the selector, false if not
   */
  matchesSelector: function (element, selector) {
    const matchesImpl = element.matches || element.webkitMatchesSelector || element.mozMatchesSelector || element.msMatchesSelector || (s => matchesSelector_SLOW(element, s));
<<<<<<< HEAD
    return matchesImpl.call(element, selector);
  }

};

=======

    return matchesImpl.call(element, selector);
  }
};
>>>>>>> b22d4f639358533e1bbd355b77d7a3342c6a63e8
module.exports = CSSCore;